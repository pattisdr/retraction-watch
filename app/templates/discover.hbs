{{title 'Search'}}

<div class="retraction-watch-search-header"> {{! DISCOVER PAGE - RETRACTION WATCH}}
    <div class="container">
        <div class="row m-v-md ">
            <div class="col-xs-12 text-center">
                <div class="retraction-watch-brand"></div>  {{!RETRACTION WATCH LOGO}}
            </div>
        </div>
        <div class="row m-t-sm m-b-lg">
            <div class="col-xs-12 col-sm-8 col-sm-offset-2">
                <div class="input-group input-group-lg"> {{!SEARCH BOX}}
                    {{input id="searchBox" value=q class="form-control" key-up='search' placeholder=(t "discover.search.placeholder")}}
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="button" {{action "search"}}>{{t "global.search"}}</button>
                    </span>
                </div>
                {{!POWERED BY SHARE}}
                <p class="lead text-center">{{t "discover.search.paragraph"}} <a href="https://share.osf.io/" class="share-logo" title="SHARE" onclick={{action 'click' 'link' 'Retraction Watch - Discover - Share Logo'}}></a></p>

            </div>
        </div>

        <div class="row m-v-md"> {{!SORT BY}}
            <div class="col-xs-6 col-xs-offset-6">
                <span class="pull-right">
                    <select
                        onchange={{action 'selectSortOption' value="target.value"}}
                        class="btn-select discover-filter-facets">
                        {{#each sortOptions as |sortChoice|}}
                            <option value={{sortChoice.sortBy}} selected={{eq sort sortChoice.sortBy}}>{{sortChoice.display}}</option>
                        {{/each}}
                    </select>
                </span>
            </div>
        </div>
    </div>
</div>

<div class="retraction-watch-search-main p-v-xl">
    <div class="container">
        <div class="row">
            <div class="col-sm-4 preprint-search-sidebar"> {{!LEFT PANEL}}
                {{#if showActiveFilters}}
                    <div id="activeFilters" class="well well-sm p-md">
                        <div class="row">
                            <div class="col-sm-6">
                                <h4>{{t "discover.main.active_filters.heading"}}:</h4>
                            </div>
                            <div class="col-sm-6">
                                <span class="pull-right">
                                    <button type="button" class="btn btn-default btn-sm" {{action "clearFilters"}}>{{t "discover.main.active_filters.button"}} {{fa-icon "remove"}}</button>
                                </span>
                            </div>
                        </div>
                    </div>
                {{/if}}
                <h4>{{t "discover.main.refine"}}</h4> {{!Refine Search}}
                {{!COPIED FROM EMBER-SHARE}}
                {{faceted-search
                    onChange='filtersChanged'
                    updateParams='updateParams'
                    filters=facetFilters
                    facetStates=facetStates
                    facets=facets
                    aggregations=aggregations
                }}
            </div>

            <div class="col-sm-8" id="searchResults"> {{!SEARCH RESULTS - RIGHT PANEL}}
                {{#if loading}}
                    <div class="text-center">
                        {{fa-icon 'spinner' pulse=true size=3}}
                    </div>
                {{else}}
                    {{#if numberOfResults}}
                        {{#each results as |result|}}
                            {{search-result result=result select=(action 'updateParams' 'subjects')}}
                        {{/each}}

                        <div class="row">
                            <div class="col-xs-5">
                                {{#if showPrev}}
                                    <button type="button" class="btn btn-default" {{action "previous"}}>{{t "global.prev"}}</button>
                                {{/if}}
                            </div>
                            <div class="col-xs-2">
                                <div style='text-align: center; margin-top:5px'>
                                    {{page}} {{t "discover.main.results.of"}} {{maxPages}}
                                </div>
                            </div>
                            <div class="col-xs-5">
                                <span class="pull-right">
                                    {{#if showNext}}
                                        <button type="button" class="btn btn-default" {{action "next"}}>{{t "global.next"}}</button>
                                    {{/if}}
                                </span>
                            </div>
                        </div>
                    {{else}}
                        <div class="text-muted text-center">
                            <p class="lead ">{{t "global.no_results_found"}}</p>
                            <p>{{t "discover.main.results.no_results"}}</p>
                        </div>
                    {{/if}}
                {{/if}}
            </div>
        </div>
    </div>
</div>
